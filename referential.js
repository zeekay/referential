var Referential=function(){"use strict";var t,e,n,r,i,u,o=[].slice;t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,u=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)},i=function(){var t,e,n,r,i,u,o,l,s,a;try{if(!Object.assign)return!1;if(l=new String("abc"),l[5]="de","5"===Object.getOwnPropertyNames(l)[0])return!1;for(s={},t=e=0;e<=9;t=++e)s["_"+String.fromCharCode(t)]=t;if(u=Object.getOwnPropertyNames(s).map(function(t){return s[t]}),"0123456789"!==u.join(""))return!1;for(a={},o="abcdefghijklmnopqrst".split(""),n=0,r=o.length;n<r;n++)i=o[n],a[i]=i;return"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(t){return t,!1}};var l,s,a,c,h=n=function(){return i()?Object.assign:function(){var n,i,l,s,a,c,h,f,p,g,y,d;for(y=arguments[0],p=2<=arguments.length?o.call(arguments,1):[],d=u(y),i=0,a=p.length;i<a;i++){f=p[i],n=Object(f);for(s in n)e.call(n,s)&&(d[s]=n[s]);if(t)for(h=t(n),l=0,c=h.length;l<c;l++)g=h[l],r.call(n,g)&&(d[g]=n[g])}return d}}();s=Object.prototype,a=s.hasOwnProperty,c=s.toString,"function"==typeof Symbol&&Symbol.prototype.valueOf;var f,p,g=function(t){return!!t&&!d(t)&&a.call(t,"length")&&isFinite(t.length)&&b(t.length)&&t.length>=0},y=Array.isArray||function(t){return"[object Array]"===c.call(t)},d=function(t){return"[object Boolean]"===c.call(t)},b=(l=function(t){var e;return"undefined"!=typeof window&&t===window.alert||("[object Function]"===(e=c.call(t))||"[object GeneratorFunction]"===e||"[object AsyncFunction]"===e)},function(t){return"[object Number]"===c.call(t)}),v=function(t){return"[object Object]"===c.call(t)},_=function(t){t=t||{};var e={},n=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(n,r){return"function"==typeof r&&(e[n]=e[n]||[]).push(r),t},enumerable:!1,writable:!1,configurable:!1},off:{value:function(n,r){if("*"!=n||r)if(r)for(var i,u=e[n],o=0;i=u&&u[o];++o)i==r&&u.splice(o--,1);else delete e[n];else e={};return t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(e,n){function r(){t.off(e,r),n.apply(t,arguments)}return t.on(e,r)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(r){var i,u,o,l=arguments.length-1,s=new Array(l);for(o=0;o<l;o++)s[o]=arguments[o+1];for(i=n.call(e[r]||[],0),o=0;u=i[o];++o)u.apply(t,s);return e["*"]&&"*"!=r&&t.trigger.apply(t,["*",r].concat(s)),t},enumerable:!1,writable:!1,configurable:!1}}),t},j=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};p=function(){var t;return t=0,function(){return t++}}();var m,w,O=f=function(){function t(t,e,n){this._value=t,this.parent=e,this.key=n,this._cache={},this._children={},this._numChildren=0,this._id=p(),null!=this.parent&&(this.parent._children[this._id]=this,this.parent._numChildren++),_(this)}return t.prototype._mutate=function(t){var e,n,r;this._cache={},r=this._children;for(n in r)e=r[n],e._mutate();return this},t.prototype.destroy=function(){var t,e,n;n=this._children;for(e in n)t=n[e],t.destroy();return delete this._cache,delete this._children,this.off("*"),this.parent&&(delete this.parent._children[this._id],this.parent._numChildren--),this},t.prototype.value=function(t){return this.parent?null!=t?this.parent.set(this.key,t):this.parent.get(this.key):(null!=t&&(this._value=t),this._value)},t.prototype.ref=function(e){return e?new t(null,this,e):this},t.prototype.get=function(t){return t?this._cache[t]?this._cache[t]:this._cache[t]=this.index(t):this.value()},t.prototype.set=function(t,e){var n,r,i;if(v(t)){for(n in t)i=t[n],this.set(n,i);return this}return r=this.get(t),this._mutate(t),null==e?this.value(h(this.value(),t)):this.index(t,e),this._triggerSet(t,e,r),this._triggerSetChildren(t,e,r),this},t.prototype._triggerSetChildren=function(t,e,n){var r,i,u,o,l,s,a,c,h,f,p,g;if(0===this._numChildren)return this;t+="",a=t.split("."),c="",i=[],p={};for(o in a)s=a[o],""===c?c=s:c+="."+s,i[o]=c,p[c]=new RegExp("^"+c+".?");h=this._children,g=[];for(l in h)r=h[l],f=r.key,j.call(i,f)>=0?(u=t.replace(p[r.key],""),r.trigger("set",u,e,n),g.push(r._triggerSetChildren(u,e,n))):g.push(void 0);return g},t.prototype._triggerSet=function(t,e,n){var r;if(this.trigger("set",t,e,n),this.parent)return r=this.key+"."+t,this.parent._triggerSet(r,e,n)},t.prototype.extend=function(t,e){var n;return this._mutate(t),null==e?this.value(h(this.value(),t)):v(e)?this.value(h(this.ref(t).get(),e)):(n=this.clone(),this.set(t,e),this.value(h(n.get(),this.value()))),this},t.prototype.clone=function(e){return new t(h({},this.get(e)))},t.prototype.index=function(t,e,n,r){var i,u,o;if(null==n&&(n=this.value()),this.parent)return this.parent.index(this.key+"."+t,e);if(b(t)&&(t=String(t)),o=t.split("."),null!=e)for(;u=o.shift();){if(!o.length)return n[u]=e;i=o[0],null==n[u]&&(isNaN(Number(i))?null==n[u]&&(n[u]={}):null==n[u]&&(n[u]=[])),n=n[u]}else for(;u=o.shift();){if(!o.length)return null!=n?n[u]:void 0;n=null!=n?n[u]:void 0}},t}();return m=["extend","get","index","ref","set","value","on","off","one","trigger"],w=function(t,e){var n,r,i,u,o;for(null==e&&(e=null),null==e&&(e=new O(t)),o=function(t){return e.get(t)},n=function(t){return o[t]=function(){return e[t].apply(e,arguments)}},r=0,i=m.length;r<i;r++)u=m[r],n(u);return o.refer=function(t){return w(null,e.ref(t))},o.clone=function(t){return w(null,e.clone(t))},o},w.Ref=O,w}();
